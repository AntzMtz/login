<!DOCTYPE html>
<html>

<head>
    <title>Almacen</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>



<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="utf-8">

    <title>Get Current URL in JavaScript</title>
    <!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script> -->
    <style>
        td {
            padding: 5px;
            background-color: chartreuse;
            width: 50%;
            border-top: 1px dashed forestgreen;
            margin: 15px auto;
            text-align: center;
        }
        
        div {
            margin: 2px auto;
        }
    </style>

</head>


<body>


    <div>
        <h1 id="Titulo">AJAX</h1>
        <button type="button" id="boton">Get Page URL</button>
        <ul id="list">

        </ul>
    </div>
    <div>
        <form name="registro_usuarios" id="registro">
            <h1 id="Titulo2">AJAX POST</h1>
            <div>
                Usuario: &nbsp;
                <input type="text" id="user">
            </div>
            <div>
                Contrase√±a:&nbsp;
                <input type="text" id="pass">
            </div>
            <div>
                <input type="button" id="BotonReg" value="Registro">
            </div>
        </form>
    </div>
    <script>
        var boton = document.getElementById("boton");
        boton.addEventListener('click', () => {
            let xhr;
            // const Url30 = 'https://gsindical-gral-lazarocardenas.herokuapp.com/dishes';
            const Url30 = "http://localhost:5000/products";
            if (window.XMLHttpRequest) {
                xhr = new XMLHttpRequest();
                console.log("si tiene");
                xhr.open('GET', Url30);
                xhr.addEventListener('load', (data) => {
                    console.log("datos: " + data.timeStamp);

                    // console.log(JSON.parse(data.target.response))


                    // var JSONDATA = (JSON.parse(data.target.response))
                    // var obj = JSONDATA[0].comments;
                    // console.log(obj);
                    // var body = document.getElementsByTagName("body")[0];
                    // var list = document.getElementById("list")
                    // list = document.createElement("TABLE")
                    // var tblBody = document.createElement("tbody");

                    // var hilera;
                    // var celda;
                    // var texto;

                    // hilera = document.createElement("tr")
                    // for (var i = 0; i < 2; i++) {
                    //     celda = document.createElement("td");
                    //     if (i == 0) {
                    //         Salida = "_ID";

                    //     } else if (i == 1) {
                    //         Salida = "RATING";
                    //     }
                    //     texto = document.createTextNode(Salida);
                    //     celda.appendChild(texto);
                    //     hilera.appendChild(celda);
                    //     tblBody.appendChild(hilera);


                    // }



                    // for (var useri of obj) {
                    //     console.log(useri._id);
                    //     hilera = document.createElement("tr")
                    //     for (var i = 0; i < 2; i++) {
                    //         celda = document.createElement("td");
                    //         if (i == 0) {
                    //             Salida = `${useri._id}`;

                    //         } else if (i == 1) {
                    //             Salida = `${useri.rating}`;
                    //         }
                    //         texto = document.createTextNode(Salida);
                    //         celda.appendChild(texto);
                    //         hilera.appendChild(celda);
                    //         tblBody.appendChild(hilera);


                    //     }
                    // }
                    // list.appendChild(tblBody);
                    // body.appendChild(list);

                })
                xhr.send()

            } else {
                xhr = new ActiveXObject("Microsoft.XMHTTP")
            }

        })
    </script>
    <script>
        var boton = document.getElementById("BotonReg");
        var dat = document.getElementById("user");

        boton.addEventListener('click', () => {
            let xhr;
            var URLactual = window.location.href;
            // console.log("URL: " + URLactual);

            var Salida = {
                newItem: dat.value,
                newUrl: URLactual
            };

            const Url30 = "http://localhost:5000/new-products";
            if (window.XMLHttpRequest) {

                xhr = new XMLHttpRequest();
                console.log("si tiene");
                const j34 = JSON.stringify(Salida);
                // console.log(j34);
                xhr.open('POST', Url30);


                xhr.setRequestHeader('Content-Type', "application/json");
                xhr.onload = function() {
                    // do something to response
                    console.log("Respo"+xhr.response);
                };
                xhr.send(j34);



                // xhr.addEventListener('load', (data) => {
                //     console.log("datos: " + data.timeStamp);





            } else {
                console.error("No Soporta");


            }
        })





        // const sendData = (data) => {
        //         let xhr1
        //         if (window.XMLHttpRequest) {
        //             xhr1 = new XMLHttpRequest()
        //             console.log("Si soporta");
        //             console.log(data);

        //             //         const formData = new FormData(data);

        //             //     } else {
        //             //         console.log("No soporta");

        //             //     }
        //         }

        //         // regi.addEventListener("click", (e) => {
        //         //     e.preventDefault()
        //         //     console.log("sidio click");
        //         //     sendData(form1);

        //         // })
    </script>



</body>

</html>